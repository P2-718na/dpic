\title{Controllo di sistemi lineari}
\maketitle
\label{sec:linear-systems-and-control}

La teoria del controllo dei sistemi lineari è molto robusta e fornisce gli
strumenti... \todo{intro a questo capitolo}

\iffalse
\section{Sistemi lineari}
La definizione di sistema lineare cambia leggermente a seconda di che si parli
di un sistema a tempo continuo o discreto.
È quindi opportuno enunciare la seguente definizione:

\todo{sistema numeraione delle definizioni}
\begin{definition}
    Un \textbf{insieme del tempo} $\mathcal T$ è un sottogruppo di $(\R, +)$.
\end{definition}
Nella pratica, $\mathcal T$ coinciderà sempre con $\R$ o con $\Z$, a seconda
che il sistema sia a tempo continuo o discreto, rispettivamente.
Inoltre, quando è definito un insieme del tempo $\mathcal T$, si assume che tutti gli
intervalli siano ristretti a $\mathcal T$.

\begin{definition}[Sistema]
    La quadrupla $\Sigma = (\mathcal T, \mathcal X, \mathcal U, \phi)$,
    dove:
    \begin{itemize}
        \item $\mathcal T$ è un insieme del tempo.
        %zzz
        \item $\mathcal X$ è un insieme non vuoto, detto \textbf{spazio delle fasi}.
        %
        \item $\mathcal U$ è un insieme non vuoto, detto \textbf{spazio dei controlli ammissibili}.
        %
        \item $\phi: D_\phi \to \mathcal X$ è un'applicazione, detta \textbf{flusso di fase},
        definita su: \\ \\
                $D_\phi :=
                   \left{
                       (\tau, \sigma, x, u) \mid
                       \sigma, \tau \in \mathcal T, \sigma < \tau, x \in \mathcal X, u \in \mathcal U^{[\sigma, \tau)}
                   \right}$, \\ \\
        \todo{porco dio non so come avere spacing per questa roba diomerda latex kys}
        dove $\mathcal U^{[\sigma, \tau)} := \left{u \mid u: [\sigma, \tau) \to \mathcal U \right}$.
    \end{itemize}
    È detta \textbf{sistema} se valgono le seguenti proprietà:
    \begin{itemize}
        \item \textbf{Non-banalità:}
        \item \textbf{Restrizione:}
        \item \textbf{Semigruppo:}
        \item \textbf{Identità:}
    \end{itemize}
\end{definition}
\fi
%qui sopra devo semplificare un attimo la definizione. Still, do definizione
%di sistema e di sistema lineare.
%la cosa migliore è partire da flusso di fase, dare definizione di campo vettoriale
%e vedere come passare da uuno all'altro.

\section{Sistemi lineari}
\todo{scrivi qualcosa qui}

\subsection{Sistemi dinamici}
In questo testo ho già usato la parola "sistema" più volte, senza però darne
una definizione rigorosa.
Quello a cui mi riferisco è un \emph{sistema dinamico}, di cui ora darò una definizione.

\paragraph {}
Inizio introducendo il concetto di \emph{spazio delle fasi} e \emph{flusso di fase}.

\begin{definition}
    Lo \textbf{spazio delle fasi}, detto anche \textbf{spazio degli stati}, di
    un sistema fisico è l'insieme di tutti i possibili stati del sistema.
\end{definition}

\begin{definition}
    Sia $t \in \mathcal T \subseteq \R^+$. Siano $x_0, x(t) \in \Sigma$ spazio delle fasi.
    L'applicazione: \\
    \begin{equation*}
        \begin{array}{cccc}%
            \phi: &\mathcal T \times \Sigma &\to &\Sigma \\
            &\phi^t(x_0) &\mapsto &x(t)
        \end{array}%
    \end{equation*}
    è detta \textbf{flusso di fase} se e solo se rispetta le seguenti proprietà:
    \begin{itemize}
        \item \textbf{Identità:} $\phi^0(x_0) = x_0$.
        \item \textbf{Composizione:} $\phi^t \o \phi^s = \phi^{t+s}$.
        \item \textbf{Conservazione della misura:} esiste una misura $\mu$ di $\Sigma$ %
        conservata $\int_A \det J_\phi \ d\mu = \int_{\phi^t(A)} d\mu$.
    \end{itemize}
\end{definition}

Concettualmente, il flusso di fase è uno strumento che mi permette di sapere
quale sarà lo stato futuro $x(t)$ di un sistema, conoscendo solamente lo stato
iniziale $x_0 = x(0)$.
Facciamo un esempio.

\begin{example}[Semaforo]
    \label{ex:semaforo}
    Voglio descrivere il comportamento di un semaforo stradale.
    Il semaforo può essere o verde o rosso e cambia colore a intervalli regolari.
    Posso quindi definire lo spazio delle fasi del sistema come:
    \begin{equation*}
        \Sigma := \{\text{V}, \text{R} \}.
    \end{equation*}
    Il tempo è discreto: $\mathcal T \equiv \Z^+$ e il flusso di fase è definito come:
    \begin{equation*}
         \phi^t(\text R) = \left\{
         \begin{array}{lrl}
             V &$t$ &dispari\\
             R &$t$ &pari
         \end{array}
         \right.
    \end{equation*}
    \begin{equation*}
        \phi^t(\text V) = \left\{
        \begin{array}{lrl}
            R &$t$ &dispari\\
            V &$t$ &pari
        \end{array}
        \right.
        .
    \end{equation*}
    La tripla $(\Sigma, \mathcal T, \phi)$ che ho appena descritto è un \emph{sistema dinamico}.
    Un esempio come questo, seppur banale, rende chiaro come l'effetto di $\phi$ sia
    di \emph{saltare} da un punto ad un altro nello spazio delle fasi (Figura \ref{fig:esempio-semaforo}).

    \begin{center}
        \includegraphics[width=0.4\textwidth]{assets/ex-semaforo.png}
        \captionof{figure}{Some figure}
        \label{fig:esempio-semaforo}
    \end{center}
\end{example}

È quindi immediato enunciare la definizione di \emph{sistema dinamico}:

\begin{definition}
    La tripla $(\Sigma, \mathcal T, \phi)$ in cui:
    \begin{itemize}
        %todo inserisci cosa sono i tre elementi.
        \item culo
    \end{itemize}
    è detta \textbf{sistema dinamico}.
\end{definition}

L'insieme $\mathcal T$ è chiamato \textbf{insieme del tempo} e può essere continuo
o discreto (Vedi: esempio \ref{ex:semaforo}) (generalmente si prende $\mathcal T \equiv \R^+$ oppure $\mathcal T \equiv \Z^+$).

\paragraph{}
Spesso, dalla semplice osservazione di un sistema fisico, non se ne riesce a determinare
immediatamente il flusso di fase associato. Possiamo invece costruire un \emph{campo vettoriale} $\b a(\b x)$
che descrive il moto tramite un sistema di equazioni differenziali
\begin{equation*}
    \b a(\b x) = \dot {\b x} (t),
\end{equation*}
dove $\b x(t)$ è la \emph{legge oraria} del sistema.
È naturale quindi chiedersi \emph{come e se} sia possibile passare da flusso di
fase a campo vettoriale e viceversa. Si può dimostrare \todo{devo mettere la dimostrazione?} che
i due oggetti sono legati secondo l'equazione:
\begin{equation}
    \b a (\b x) = \left.\frac d {dt} \right| _{t=0} \phi^t (\b x_0).
    \label{eq:campo-vettoriale}
\end{equation}

La \eqref{eq:campo-vettoriale} è, in generale, impossibile da integrare analiticamente.
Tuttavia, per i sistemi lineari, esiste una soluzione in forma chiusa che permette di
risalire a $\phi$ partendo da $\b a$. Vedremo come nel prossimo paragrafo.

\todo{eventualmente, posso fare un esempio di campo vettoriale mostrando il flow delle fasi...
Non so se serve, per ora non lo faccio.}


\subsection{Equazioni differenziali lineari}
Iniziamo con due righe di teoria sulle equazioni differenziali:

\begin{definition}
    Sia $\b x = \b x(t) \in \R^n$, $A \in \M_{2\times 2}(\R)$. Un'equazione nella forma
    \begin{equation}
        \dot{\b x} = A \b x
        \label{eq:sistema-lineare}
    \end{equation}
    è detta \textbf{equazione differenziale omogenea (\textsc{ODE}) lineare di \rom{1} ordine.}
    \label{def:sistema-lineare}
\end{definition}
\todo {glossario e small caps}

Per le ODE di questo tipo esiste una soluzione analitica data da
\begin{equation}
    \b x(t) = e^{\b A t} \b x(0).
    \label{eq:soluzione-lineare}
\end{equation}
Basta infatti sostituire la definizione di esponenziale di matrice
\begin{equation}
    e^{A} := \sum_{k=0}^{+\infty} \frac{A^k}{k!}
    \label{eq:exp-matrice}
\end{equation}
nell'equazione \eqref{eq:sistema-lineare} e verificare che si ottiene un'identità.
Inoltre, il \emph{Teorema di Esistenza e Unicità} ci garantisce che questa soluzione
trovata è unica.

\paragraph{}
Ora, prendo in considerazione un sistema dinamico che ha come campo vettoriale associato
l'equazione \eqref{eq:sistema-lineare}. Osservo che la soluzione \eqref{eq:soluzione-lineare}
corrisponde proprio al flusso di fase associato al sistema. Infatti, se prendo
$\phi^t(\b x) = e^{At} \b x$ e lo inserisco nella \eqref{eq:campo-vettoriale},
trovo proprio
\begin{equation*}
    \begin{array}{ll}
        \left. \frac d{dt} \right|_{t=0} e^{At} \b x_0 &= \\
        &= A e^{A0} \b x  \\
        &= A \b x.
    \end{array}
\end{equation*}

\paragraph{}
\todo {aaaa} Qui devo dire qualcosa riguardo alla possibilità di calcolare
esponenziale di matrici per sistemi diagonalizzabili.


\paragraph{}
Questa possibilità di ricavare il flusso di fase partendo dal campo vettoriale per
sistemi lineari vale anche nel caso in cui questi siano \emph{non omogenei}.
Questo fatto ci è molto utile, visto che permetterà di passare da sistemi a tempo
continuo a sistemi a tempo discreto. Vediamo come.

\begin{definition}
    %todo definizione eq non omogenea
    ax +bu
    \label{def:sistema-lineare}
\end{definition}
\todo {glossario e small caps}

%todo
e questa ha soluzione.... Boh


\subsection{Analisi dello spettro di $A$}
In un sistema lineare, le soluzioni asintotiche possono avere tre comportamenti:
0, +inf, oscillare. Questo dipende dagli autovalori...
%todo
e qui mostro nel caso diagonale come funzionano le dinamiche e spiego come l'esponenziale
di matrice sia il mapping che mi fa passare da una cosa all'altra.

\section{Linearizzazione di un sistema}
qua ci metto la teoria delle piccole oscillazioni di bazzani

\section{Controllabilità di un sistema lineare}
Qui devo spiegare che controllabilità equivale a poter spostare gli autovalori a piacimento.
Mostro le condizioni di controllabilità e qualche teoremino. Non so se mettere le
dimostrazioni (no sbatti per ora, magari metto solo le citazioni).

\section{Controllo ottimale: LQR} \todo {glossary LQR}
Qui mi diverto